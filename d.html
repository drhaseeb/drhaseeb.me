<html>
<body>
  <form>
    <select></select>
    <div id="row"></div>div>
  </form>
// Load the Google Sheets API
<script src="https://apis.google.com/js/api.js"></script>

// Initialize the API client
<script>
  var API_KEY = 'AIzaSyDdXpNR_fkUK2YYz4zpdcL0_thO1bGCFDU'; // Replace with your API key
  var SPREADSHEET_ID = '1npHjzp9Y8RxJhsb-ehdRrE9fIWLguzoH6WYaAYcThwo'; // Replace with your spreadsheet ID
  var RANGE = 'A1:N'; // Replace with your range of data

  function initClient() {
    gapi.client.init({
      apiKey: API_KEY,
      discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    }).then(function () {
      // Get the data from the spreadsheet
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SPREADSHEET_ID,
        range: RANGE,
      }).then(function(response) {
        // Display the data as a form
        displayForm(response.result.values);
      }, function(error) {
        // Handle the error
        console.error(error);
      });
    });
  }

  // Load the API client on page load
  gapi.load('client', initClient);
</script>

// Display the data as a form
<script>
  function displayForm(data) {
    // Create a form element
    var form = document.createElement('form');
    form.method = 'post';

    // Create a serial number selector
    var select = document.createElement('select');
    select.name = 'serial';
    select.addEventListener('change', function() {
      // Display the row with the selected serial number
      var serial = parseInt(select.value);
      if (serial >= 1 && serial < data.length) {
        displayRow(data, serial);
      }
    });
    form.appendChild(select);

    // Create an option for each serial number
    for (var i = 1; i < data.length; i++) {
      var option = document.createElement('option');
      option.value = i;
      option.innerText = data[i][0];
      select.appendChild(option);
    }

    // Create a div to display the row data
    var rowDiv = document.createElement('div');
    rowDiv.id = 'row';
    form.appendChild(rowDiv);

    // Display the first row by default
    displayRow(data, 1);

    // Create a submit button
    var submit = document.createElement('input');
    submit.type = 'submit';
    submit.value = 'Update';
    submit.addEventListener('click', function(event) {
      // Prevent the default form submission
      event.preventDefault();
      // Update the spreadsheet with the form data
      updateSpreadsheet(data, select.value);
    });
    form.appendChild(submit);

    // Append the form to the body of the document
    document.body.appendChild(form);
  }

  // Display the row data as input fields
  function displayRow(data, serial) {
    // Get the row div element
    var rowDiv = document.getElementById('row');
    // Clear the previous row data
    rowDiv.innerHTML = '';
    // Create a label and an input for each column
    for (var i = 0; i < data[0].length; i++) {
      var label = document.createElement('label');
      label.innerText = data[0][i] + ': ';
      rowDiv.appendChild(label);
      var input = document.createElement('input');
      input.name = data[0][i];
      input.value = data[serial][i];
      rowDiv.appendChild(input);
      rowDiv.appendChild(document.createElement('br'));
    }
  }

  // Update the spreadsheet with the form data
  function updateSpreadsheet(data, serial) {
    // Get the form element
    var form = document.querySelector('form');
    // Get the form data as an array
    var formData = [];
    for (var i = 0; i < data[0].length; i++) {
      formData.push(form.elements[data[0][i]].value);
    }
    // Update the spreadsheet with the form data
    gapi.client.sheets.spreadsheets.values.update({
      spreadsheetId: SPREADSHEET_ID,
      range: 'A' + (parseInt(serial) + 1) + ':N' + (parseInt(serial) + 1),
      valueInputOption: 'USER_ENTERED',
      values: [formData]
    }).then(function(response) {
      // Display a success message
      alert('Spreadsheet updated successfully!');
    }, function(error) {
      // Display an error message
      alert('Spreadsheet update failed: ' + error.message);
    });
  }
</script>


  
</body>
</html>
